{% extends "base.html" %}
{% load static %}

{% block title %}User Dashboard{% endblock %}


{% block extra_head %}
    <link rel="stylesheet" href="{% static '/css/dashboard.css' %}">
{% endblock %}


{% block content %}



{% if messages %}
  <div class="messages black-border bg-a-white p-3 mt-3">
    {% for message in messages %}
      <p{% if message.tags %} class="{{ message.tags }} m-0"{% endif %}>{{ message }}</p>
    {% endfor %}
  </div>
{% endif %}




{% include "dash-userdetails.html" %}
{% include "dash-cards.html" %}
{% include "dash-subscription.html" %}
{% include "dash-download.html" %}

 
 

{% include "dash-change-details.html" %}
{% include "dash-change-pass.html" %}
{% include "dash-delete-account.html" %}

<script>
 
 
  function upgradeToPremium() {
    console.log("Upgrading...");  // Add this line
    fetch('/subscription/subscribe_premium/', {  // Replace with the actual endpoint that returns the session ID
      method: 'GET',
      headers: {
        'Content-Type': 'application/json',
        'X-Requested-With': 'XMLHttpRequest',  // This tells Django that it's an AJAX request
    },
    })
    .then(response => {
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    return response.json();
    })
    .then(data => {
      console.log(data)
      var stripe = Stripe(data.stripe_public_key);
      stripe.redirectToCheckout({
        sessionId: data.session_id
      }).then(function (result) {
        console.log(result);
      });
    })
    .catch((error) => {
      console.error('Fetch error:', error);
    });
  }
  
</script>

    
{% endblock %}


{% block extra_js %}

{% endblock %}